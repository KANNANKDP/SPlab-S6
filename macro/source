read  macro ip,buf
0     td    ip
0     jeq   read
0     rd    ip
0     stch  buf
0     mend  read
rdrec start 1000
0     ldx   zero
rloop lda   zero
0     read  input,buffer
0     comp  zero
0     jeq   exit
0     tix   maxlen
0     jlt   rloop
exit  stx   length
input byte  x'f1'
maxlen  word 4096
zero    word 0
buffer  resb 4096
length  resw 1
0       end  rdrec
